---
layout: page
title:  Мутаторы (сеттеры)
date: 2016-11-28 15:51:55 UTC
categories: ru
---

   Поддержка мутаторов (сеттеров) в Otus Lisp сильно ограничена, так как olvm и используемая модель памяти диктуют свои, довольно жесткие, условия.
   
   Посему, в качестве аргумента мутатора могут выступать только значения value типа - такие как:

  * небольшие числа (умещающиеся в 24 бита для 32-разрядных систем и в 56 бит для 64-разрядных систем, а если проще, то меньшие за 16777215 и 72057594037927935 соответственно
  * символы
  * логические значения (#true и #false)
  * пустой список ('() или null)
  * пустая хеш-таблица (#empty)
  * символ конца файла (#oef)

   На данный момент полностью реализованы и проходят тестирование операторы set-car! и set-cdr!, которые устанавливают соответствующий элемент пары в заданное значение. По результатам тестирования появятся и остальные операторы - string-set!, vector-set!, setb! и, возможно, другие.

   Необходимо отметить, что сеттеры нарушают некоторые из основ функционального программирования и поэтому должны применяться очень осторожно (знак восклицания в конце имени этих операторов вполне прозрачно на это намекает). Но некоторая необходимость в них все же существует, как, например, в генераторе случайных чисел. Или рандомное изменение малого количества элементов большого массива, когда чисто функциональный подход может оказаться слишком требовательным к ресурсам.

   В качестве теста мутаторов в основной репозиторий был подготовлен и добавлен пример [Matrix](https://github.com/yuriy-chumak/ol/tree/master/tutorial/Matrix), который рисует в окошке "цифровой дождь". Вывод настраивается с помощью нескольких констант:

  * SLIDING-MODE - стиль дождя
    * 0: без слайдеров
    * 2: только слайдеры
    * 1: смешанный
  * WIDTH - количество глифов по горизонтали
  * HEIGHT - количество глифов по вертикали
  * PHOSPHOR-ENABLED - включить свечение глифов
  * RANDGLOW-ENABLED - включить свечение слайдеров

  ![Скрин окна вывода](assets/matrix-64x56.png)